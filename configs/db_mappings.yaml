# ============================================================
# DB块映射配置文件
# ============================================================
# 用于配置 PLC 中各个 DB 块的映射关系
# 修改此文件后无需修改 Python 代码，重启服务即可生效
# ============================================================

# ============================================================
# 轮询配置
# ============================================================
polling_config:
  poll_interval: 5  # 兼容字段（与 .env PLC_POLL_INTERVAL 保持一致）
  realtime_poll_interval: 5  # 实时数据轮询间隔（DB8/DB9/DB10）
  status_poll_interval: 5  # 状态位轮询间隔（DB3/DB7/DB11）
  batch_write_size: 10  # 批量写入间隔 (次数)，与 .env BATCH_WRITE_SIZE 一致

# ============================================================
# 设备状态位配置 - 用于检测各设备模块通信状态
# ============================================================
# 后端只负责读取原始字节数据并缓存，前端负责解析
# ============================================================
device_status_config:
  enabled: true
  poll_with_data: true  # 与数据轮询同步读取
  db_blocks:
    # DB3 - 料仓(回转窑)设备状态
    - db_number: 3
      db_name: "KilnState"
      total_size: 148
      description: "料仓设备状态（4短有称重+2短无称重+3长有称重）"

    # DB7 - 辊道窑设备状态
    - db_number: 7
      db_name: "RollerKilnState"
      total_size: 72
      description: "辊道窑设备状态（6温度+6×2电表）"

    # DB11 - SCR设备和风机状态
    - db_number: 11
      db_name: "SCRDeviceState"
      total_size: 40
      description: "SCR设备和风机状态（2SCR+2风机）"

# ============================================================
# 数据块映射
# ============================================================
db_mappings:
  # DB8 - 料仓设备
  - db_number: 8
    db_name: "DB8_Hoppers"
    total_size: 626
    config_file: "configs/config_hoppers.yaml"
    parser_class: "HopperParser"
    enabled: true
    description: "9个料仓设备（4短+2无+3长）"
  
  # DB9 - 辊道窑
  - db_number: 9
    db_name: "DB9_RollerKiln"
    total_size: 348
    config_file: "configs/config_roller_kiln.yaml"
    parser_class: "RollerKilnParser"
    enabled: true
    description: "辊道窑（6温度+6电表）"
  
  # DB10 - SCR设备和风机
  - db_number: 10
    db_name: "DB10_SCR_Fans"
    total_size: 244
    config_file: "configs/config_scr_fans.yaml"
    parser_class: "SCRFanParser"
    enabled: true
    description: "SCR设备和风机（2SCR+2风机）"
